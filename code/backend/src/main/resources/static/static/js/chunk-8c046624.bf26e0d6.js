(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8c046624"],{"2a49":function(e,t,s){},"3feb":function(e,t,s){"use strict";s("9b16")},"4fc4":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-container"},[t("div",{staticClass:"main-content"},[e._t("default")],2)])},r=[],n={name:"PageBody"},i=n,o=(s("c95a"),s("2877")),d=Object(o["a"])(i,a,r,!1,null,"7617c039",null);t["a"]=d.exports},5834:function(e,t,s){"use strict";s("2a49")},"6e70":function(e,t,s){"use strict";var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"header"},[t("div",{staticClass:"header-container"},[t("div",{staticClass:"app-name"},[t("router-link",{attrs:{to:"/"}},[e._v("Campus Exchange")])],1),t("div",{staticClass:"search-container"},[t("el-input",{attrs:{placeholder:"Search item..."},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchIdle.apply(null,arguments)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchIdle},slot:"append"})],1)],1),t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.toRelease}},[e._v("Create new listing")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-chat-dot-round"},on:{click:e.toMessage}},[e._v("Message")]),e.isLogin?t("el-dropdown",{attrs:{trigger:"click"}},[t("div",{staticStyle:{cursor:"pointer",display:"flex","align-items":"center"}},[t("div",{staticStyle:{"font-size":"16px",color:"#409EFF","padding-right":"5px"}},[e._v(e._s(e.nicknameValue?e.nicknameValue:e.nickname))]),t("el-avatar",{attrs:{src:e.avatarValue?e.avatarValue:e.avatar}})],1),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[t("div",{on:{click:e.toMe}},[e._v("Profile")])]),t("el-dropdown-item",{staticStyle:{color:"red"},attrs:{divided:""}},[t("div",{on:{click:e.loginOut}},[e._v("Logout")])])],1)],1):t("router-link",{staticClass:"user-name-text",attrs:{to:"/login"}},[e._v("Login")])],1)])},r=[],n=(s("a481"),{name:"Header",props:["searchInput","nicknameValue","avatarValue"],data:function(){return{searchValue:this.searchInput,nickname:"Login",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",isLogin:!1}},created:function(){var e=this;this.$globalData.userInfo.nickname?(this.nickname=this.$globalData.userInfo.nickname,this.avatar=this.$globalData.userInfo.avatar,this.isLogin=!0):this.$api.getUserInfo().then((function(t){console.log("Header getUserInfo:",t),1===t.status_code&&(e.nickname=t.data.nickname,e.avatar=t.data.avatar,t.data.signInTime=t.data.signInTime.substring(0,10),e.$globalData.userInfo=t.data,e.isLogin=!0)}))},methods:{searchIdle:function(){"/search"!==this.$route.path?this.$router.push({path:"/search",query:{searchValue:this.searchValue}}):(this.$router.replace({path:"/search",query:{searchValue:this.searchValue}}),this.$router.go(0))},toMe:function(){"/me"!==this.$route.path&&this.$router.push({path:"/me"})},toMessage:function(){"/message"!==this.$route.path&&this.$router.push({path:"/message"})},toRelease:function(){"/release"!==this.$route.path&&this.$router.push({path:"/release"})},loginOut:function(){var e=this;this.$api.logout().then((function(t){1===t.status_code?(e.$globalData.userInfo={},console.log("login out"),"/index"===e.$route.path?e.$router.go(0):e.$router.push({path:"/index"})):e.$message.error("Network or system error, fail to logout.")}))}}}),i=n,o=(s("3feb"),s("2877")),d=Object(o["a"])(i,a,r,!1,null,"3e476e82",null);t["a"]=d.exports},"71c17":function(e,t,s){},"7c83":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("app-head"),t("app-body",[t("div",{staticClass:"order-page-container"},[t("div",{staticClass:"idle-info-container",on:{click:function(t){return e.toDetails(e.orderInfo.idleItem.id)}}},[t("el-image",{staticStyle:{width:"150px",height:"150px"},attrs:{src:e.orderInfo.idleItem.imgUrl,fit:"cover"}}),t("div",{staticClass:"idle-info-title"},[e._v("\n                    "+e._s(e.orderInfo.userId==e.userId?"Purchased":"Sold")+"ï¼š"+e._s(e.orderInfo.idleItem.idleName)+"\n                ")]),t("div",{staticClass:"idle-info-price"},[e._v("$"+e._s(e.orderInfo.orderPrice))])],1),t("div",{staticClass:"address-container",style:e.orderInfo.userId==e.userId&&0===e.orderInfo.orderStatus?"cursor: pointer;":"",on:{click:function(t){return t.stopPropagation(),e.selectAddressDialog.apply(null,arguments)}}},[t("div",{staticClass:"address-title"},[e._v("Shipping Address: "+e._s(e.addressInfo.consigneeName)+" "+e._s(e.addressInfo.consigneePhone))]),t("div",{staticClass:"address-details"},[e._v(e._s(e.addressInfo.detailAddress))]),e.addressInfo.detailAddress?e._e():t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return t.stopPropagation(),e.selectAddressDialog.apply(null,arguments)}}},[e._v("\n                    Select Shipping Address")])],1),t("el-dialog",{attrs:{title:"Select Address",visible:e.addressDialogVisible,width:"800px"},on:{"update:visible":function(t){e.addressDialogVisible=t}}},[t("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"","empty-text":"No address information, please add an address in the personal center first",data:e.addressData}},[t("el-table-column",{attrs:{prop:"consigneeName",label:"Recipient Name",width:"120"}}),t("el-table-column",{attrs:{prop:"consigneePhone",label:"Phone Number",width:"140"}}),t("el-table-column",{attrs:{prop:"detailAddressText",label:"Address"}}),t("el-table-column",{attrs:{label:" ",width:"120"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.selectAddress(s.$index,s.row)}}},[e._v("Select ")])]}}])})],1)],1),t("div",{staticClass:"order-info-container"},[t("div",{staticClass:"order-info-title"},[e._v("Order Information ("+e._s(e.orderStatus[e.orderInfo.orderStatus])+"):")]),t("div",{staticClass:"order-info-item"},[e._v("Order Number: "+e._s(e.orderInfo.orderNumber))]),t("div",{staticClass:"order-info-item"},[e._v("Payment Status: "+e._s(1===e.orderInfo.paymentStatus?"Paid":"On Hold"))]),t("div",{staticClass:"order-info-item"},[e._v("Payment Method: "+e._s(e.orderInfo.paymentWay))]),t("div",{staticClass:"order-info-item"},[e._v("\n                    Creation Time: "+e._s(e.orderInfo.createTime.substring(0,10)+" "+e.orderInfo.createTime.substring(11,19))+"\n                ")]),t("div",{staticClass:"order-info-item"},[e._v("\n                    Payment Time:\n                    "+e._s(e.orderInfo.paymentTime?e.orderInfo.paymentTime.substring(0,10)+" "+e.orderInfo.paymentTime.substring(11,19):"")+"\n                ")])]),t("el-dialog",{attrs:{title:"Prompt",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("span",[e._v("Please click 'Pay Now' to put the product on hold. Reminder: the transaction will happen offline. Be careful.")]),t("div",{staticClass:"block"}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.putOnHold}},[e._v("Pay Now")])],1)]),t("div",{staticClass:"menu"},[e.userId==e.orderInfo.userId&&0===e.orderInfo.orderStatus?t("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){return e.changeOrderStatus(4,e.orderInfo)}}},[e._v("Cancel Order")]):e._e(),e.userId==e.orderInfo.userId&&0===e.orderInfo.orderStatus?t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.changeOrderStatus(1,e.orderInfo)}}},[e._v("Pay Now")]):e._e(),e.userId==e.orderInfo.idleItem.userId&&1===e.orderInfo.orderStatus?t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.changeOrderStatus(2,e.orderInfo)}}},[e._v("On Hold")]):e._e(),e.userId==e.orderInfo.userId&&2===e.orderInfo.orderStatus?t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.changeOrderStatus(3,e.orderInfo)}}},[e._v("Transact Offline")]):e._e()],1)],1),t("app-foot")],1)],1)},r=[],n=(s("a481"),s("28a5"),s("6e70")),i=s("4fc4"),o=s("85a9"),d={name:"order",components:{AppHead:n["a"],AppBody:i["a"],AppFoot:o["a"]},data:function(){return{dialogVisible:!1,addressDialogVisible:!1,addressData:[],orderStatus:["Pending Payment","Pending Shipment","Pending Receipt","Completed","Canceled"],orderInfo:{createTime:"",id:0,idleId:0,idleItem:{id:"",idleName:"",idleDetails:"",pictureList:[],idlePrice:0,idlePlace:"",idleLabel:"",idleStatus:-1,userId:""},orderNumber:"",orderPrice:0,orderStatus:0,paymentStatus:0,paymentTime:"",paymentWay:"",userId:0},addressInfo:{id:"",update:!1,consigneeName:"",consigneePhone:"",detailAddress:""},userId:""}},created:function(){var e=this;this.userId=this.getCookie("shUserId"),console.log("userId",this.userId,this.getCookie("shUserId"));var t=this.$route.query.id;console.log(t),this.$api.getOrder({id:t}).then((function(t){if(console.log(t),1===t.status_code){if(t.data.idleItem){var s=JSON.parse(t.data.idleItem.pictureList);s.length>0?t.data.idleItem.imgUrl=s[0]:t.data.idleItem.imgUrl=""}else t.data.idleItem={idleName:"",imgUrl:""};e.orderInfo=t.data,e.$api.getOrderAddress({orderId:e.orderInfo.id}).then((function(t){t.data?(e.addressInfo=t.data,e.addressInfo.update=!0):e.getAddressData()}))}}))},methods:{putOnHold:function(){this.orderInfo.orderStatus=2,this.orderInfo.paymentStatus=1,this.dialogVisible=!1,this.changeOrderStatus(2,this.orderInfo)},handleClose:function(){this.dialogVisible=!1},getCookie:function(e){for(var t=e+"=",s=document.cookie.split(";"),a=0;a<s.length;a++){var r=s[a].trim();if(0===r.indexOf(t))return r.substring(t.length,r.length)}return"0"},toDetails:function(e){this.$router.replace({path:"details",query:{id:e}})},selectAddressDialog:function(){this.orderInfo.userId==this.userId&&0===this.orderInfo.orderStatus&&(this.addressDialogVisible=!0,0===this.addressData.length&&this.getAddressData())},getAddressData:function(){var e=this;this.$api.getAddress().then((function(t){if(1===t.status_code){for(var s=t.data,a=0;a<s.length;a++)s[a].detailAddressText=s[a].provinceName+s[a].cityName+s[a].regionName+s[a].detailAddress;if(console.log(s),e.addressData=s,!e.addressInfo.update)for(var r=0;r<s.length;r++)s[r].defaultFlag&&e.selectAddress(r,s[r])}}))},selectAddress:function(e,t){var s=this;this.addressDialogVisible=!1,console.log(t,this.addressInfo),this.addressInfo.consigneeName=t.consigneeName,this.addressInfo.consigneePhone=t.consigneePhone,this.addressInfo.detailAddress=t.detailAddressText,this.addressInfo.update?this.$api.updateOrderAddress({id:this.addressInfo.id,consigneeName:t.consigneeName,consigneePhone:t.consigneePhone,detailAddress:t.detailAddressText}):this.$api.addOrderAddress({orderId:this.orderInfo.id,consigneeName:t.consigneeName,consigneePhone:t.consigneePhone,detailAddress:t.detailAddressText}).then((function(e){1===e.status_code?(s.addressInfo.update=!0,s.addressInfo.id=e.data.id):s.$message.error(e.msg)}))},buySuccess9:function(){this.dialogVisible=!1},changeOrderStatus:function(e,t){var s=this;2===e?(console.log("Putting order on hold"),this.addressInfo.detailAddress?this.$confirm("Confirm putting the order on hold","Order Status",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then((function(){s.dialogVisible=!0,setTimeout((function(){s.$api.updateOrder({id:t.id,orderStatus:e,paymentStatus:2,paymentWay:"On Hold"}).then((function(t){1===t.status_code&&(s.$message({message:"Order is now on hold!",type:"success"}),s.orderInfo.orderStatus=e,s.orderInfo.paymentStatus=2,s.orderInfo.paymentWay="On Hold")}))}),2e3)})).catch((function(){})):this.$message.error("Please select an address!")):this.$api.updateOrder({id:t.id,orderStatus:e}).then((function(t){1===t.status_code&&(s.$message({message:"Operation Successful!",type:"success"}),s.orderInfo.orderStatus=e)}))}}},l=d,c=(s("5834"),s("2877")),u=Object(c["a"])(l,a,r,!1,null,"82e27c2e",null);t["default"]=u.exports},"85a9":function(e,t,s){"use strict";var a=function(){var e=this;e._self._c;return e._m(0)},r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"foot-container"},[t("div",{staticClass:"author"},[e._v("Campus Exchange")])])}],n={name:"Foot"},i=n,o=(s("e97d"),s("2877")),d=Object(o["a"])(i,a,r,!1,null,"c9fd9caa",null);t["a"]=d.exports},"9b16":function(e,t,s){},c95a:function(e,t,s){"use strict";s("ff1e")},e97d:function(e,t,s){"use strict";s("71c17")},ff1e:function(e,t,s){}}]);